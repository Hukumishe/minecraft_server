# Как сохранить мир Minecraft на Railway

## Важно: Постоянное хранилище

По умолчанию данные в контейнере Railway **не сохраняются** при перезапуске или пересборке. Чтобы мир не терялся, нужно настроить **Volume** (том) для постоянного хранения.

## Настройка Volume на Railway

### Шаг 1: Создание Volume

1. В Railway откройте ваш проект
2. Перейдите в **Settings** → найдите раздел **"Volumes"** (или **"Storage"**)
3. Нажмите **"+ New Volume"** или **"+ Add Volume"**
4. Укажите:
   - **Name**: `minecraft-world` (или любое другое имя)
   - **Mount Path**: `/minecraft/world` (путь, где будет храниться мир)
5. Нажмите **"Create"** или **"Add"**

### Шаг 2: Проверка

После создания Volume:
- Мир будет сохраняться в этом томе
- Данные не потеряются при перезапуске сервера
- Данные не потеряются при пересборке контейнера

## Где хранится мир

Мир Minecraft хранится в папке `/minecraft/world/` внутри контейнера. После настройки Volume эта папка будет привязана к постоянному хранилищу Railway.

## Ручное сохранение мира

Minecraft автоматически сохраняет мир каждые несколько минут, но вы можете принудительно сохранить:

### Через игру (РЕКОМЕНДУЕТСЯ)

**Важно:** В "View Logs" на Railway нельзя отправлять команды - это только просмотр!

**Используйте команды в игре:**
1. Подключитесь к серверу в Minecraft
2. Нажмите `/` для открытия чата
3. Введите: `/save-all`
4. Нажмите Enter

**Как стать оператором:** См. файл `КАК_ОТПРАВИТЬ_КОМАНДЫ.md`

### Через игру (если вы оператор)

Если вы добавили себя в операторы:
1. В игре нажмите `/` для открытия чата
2. Введите: `/save-all`
3. Нажмите Enter

## Резервное копирование мира

### Способ 1: Через Railway CLI

1. Установите Railway CLI (если еще не установлен):
   ```bash
   npm i -g @railway/cli
   ```

2. Войдите в Railway:
   ```bash
   railway login
   ```

3. Подключитесь к проекту:
   ```bash
   railway link
   ```

4. Скачайте мир (если Railway CLI поддерживает это)

### Способ 2: Через SSH (если доступен)

1. В Railway найдите опцию SSH подключения
2. Подключитесь к контейнеру
3. Скопируйте папку `world/`:
   ```bash
   # Внутри контейнера
   tar -czf world-backup.tar.gz world/
   ```

### Способ 3: Автоматический бэкап через скрипт

Можно настроить автоматическое резервное копирование, добавив скрипт в Dockerfile.

## Восстановление мира

Если нужно восстановить мир из бэкапа:

1. Остановите сервер в Railway
2. Загрузите бэкап мира в Volume
3. Запустите сервер

## Проверка, что мир сохраняется

1. Создайте что-то в игре (постройте дом, поставьте блок)
2. Выполните `/save-all` в консоли
3. Перезапустите сервер в Railway
4. Подключитесь снова - ваши постройки должны остаться

## Важные замечания

⚠️ **Volume обязателен!** Без Volume мир будет теряться при каждом перезапуске

⚠️ **Размер Volume**: Учтите, что мир может занимать много места. Railway предоставляет ограниченное хранилище на бесплатном плане

⚠️ **Бэкапы**: Регулярно делайте резервные копии важных миров

⚠️ **Множественные миры**: Если используете несколько миров, создайте отдельные Volume для каждого

## Решение проблем

### Мир не сохраняется

- Проверьте, что Volume создан и примонтирован правильно
- Проверьте путь монтирования: должен быть `/minecraft/world`
- Убедитесь, что Volume активен в настройках Railway

### Мир потерялся

- Проверьте Volume - возможно, данные там сохранились
- Если есть бэкап, восстановите его
- Проверьте логи сервера на наличие ошибок сохранения

### Недостаточно места

- Удалите старые логи: `logs/` (не критично)
- Удалите ненужные файлы из мира
- Рассмотрите переход на платный план Railway для большего хранилища

## Дополнительные файлы для сохранения

Помимо мира, можно сохранить:
- `whitelist.json` - белый список игроков
- `ops.json` - список операторов
- `banned-players.json` - забаненные игроки
- `banned-ips.json` - забаненные IP
- `usercache.json` - кэш пользователей

Эти файлы также хранятся в `/minecraft/` и будут сохраняться, если Volume примонтирован к `/minecraft/`.


