# Решение проблемы "Can't connect to server"

## Проблема с портом 8080 на Railway

Railway по умолчанию создает **HTTP прокси** для приложений, но Minecraft использует **TCP протокол**. Для Minecraft сервера нужно использовать **TCP Proxy**.

## Решение: Настройка TCP Proxy на Railway

### Шаг 1: Создайте TCP Proxy

1. В Railway откройте ваш проект
2. Перейдите в **Settings → Networking**
3. Найдите кнопку **"+ TCP Proxy"** (внизу страницы)
4. Нажмите на неё
5. Railway создаст TCP прокси с новым доменом

### Шаг 2: Получите новый адрес

После создания TCP Proxy вы получите:
- Новый домен (например: `minecraftserver-production-tcp.up.railway.app`)
- Порт будет автоматически настроен

### Шаг 3: Подключитесь в Minecraft

1. Откройте Minecraft
2. Multiplayer → Add Server (или Edit для существующего)
3. Введите адрес: `новый-tcp-домен.up.railway.app`
   - Обычно порт указывать не нужно для TCP Proxy
   - Но если Railway требует, используйте формат: `домен:порт`
4. Сохраните и подключитесь

## Альтернативное решение: Использование стандартного порта 25565

Если TCP Proxy не работает, можно попробовать настроить стандартный порт:

### Вариант 1: Через переменные окружения Railway

1. В Railway: **Settings → Variables**
2. Добавьте переменную:
   - **Имя**: `PORT`
   - **Значение**: `25565`
3. Перезапустите сервис

### Вариант 2: Изменить порт в Railway Networking

1. В Railway: **Settings → Networking**
2. Найдите ваш домен
3. Нажмите на иконку редактирования (карандаш)
4. Измените порт на `25565`
5. Сохраните изменения

## Проверка статуса сервера

Перед подключением убедитесь:

1. **Сервер запущен:**
   - В Railway: **Deployments** → проверьте статус (должен быть зеленый)
   - Откройте **View Logs**
   - Должно быть сообщение: `Done (XX.XXXs)! For help, type help`

2. **Версия Minecraft:**
   - Убедитесь, что версия клиента совпадает с версией сервера
   - Проверьте логи сервера для определения версии

## Правильный формат адреса

В Minecraft при добавлении сервера используйте:

```
# С TCP Proxy (рекомендуется)
minecraftserver-production-tcp.up.railway.app

# Или с явным указанием порта
minecraftserver-production-tcp.up.railway.app:25565

# Если Railway не предоставил TCP Proxy, попробуйте HTTP домен с портом
minecraftserver-production-f41c.up.railway.app:8080
```

## Частые ошибки

### "Can't connect to server"
- ✅ Убедитесь, что сервер полностью загрузился (см. логи)
- ✅ Используйте TCP Proxy вместо HTTP домена
- ✅ Проверьте правильность адреса (без опечаток)
- ✅ Убедитесь, что версия Minecraft совпадает

### "Connection timed out"
- ✅ Сервер может еще загружаться - подождите 1-2 минуты
- ✅ Проверьте, что сервер запущен в Railway
- ✅ Попробуйте перезапустить сервер

### "Connection refused"
- ✅ Сервер не запущен - проверьте статус в Railway
- ✅ Проверьте логи на наличие ошибок
- ✅ Убедитесь, что порт указан правильно

## Быстрая диагностика

1. ✅ Сервер запущен? (Railway → Deployments → статус зеленый)
2. ✅ Сервер загрузился? (Логи → "Done! For help, type help")
3. ✅ Используете TCP Proxy? (Settings → Networking → "+ TCP Proxy")
4. ✅ Правильный адрес? (Скопируйте из Railway)
5. ✅ Версия совпадает? (Проверьте логи сервера)

## Если ничего не помогает

1. Перезапустите сервер в Railway
2. Удалите сервер из списка в Minecraft и добавьте заново
3. Проверьте, что у вас есть активные кредиты на Railway (бесплатный план дает $5/месяц)
4. Попробуйте подключиться через другой клиент Minecraft (если есть)

